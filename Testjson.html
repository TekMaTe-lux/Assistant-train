<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>VÃ©rifier les retards d'un train</title>
</head>
<body>
  <h1>Retards GTFS-RT</h1>

  <label for="trainInput">NumÃ©ro du train :</label>
  <input type="text" id="trainInput" placeholder="Ex : 88783">
  <button onclick="verifierRetard()">VÃ©rifier</button>

  <div id="resultat" style="margin-top: 20px; font-family: monospace;"></div>

  <script>
    let retards = {};

    // Charger une seule fois le fichier JSON
    fetch("https://raw.githubusercontent.com/TekMaTe-lux/Assistant-train/main/Assistant-train/retards_nancymetzlux.json")
      .then(r => r.json())
      .then(data => {
        retards = data;
        console.log("âœ… JSON chargÃ© !");
      })
      .catch(err => {
        document.getElementById("resultat").innerHTML = `<p style="color:red;">Erreur de chargement : ${err}</p>`;
      });

    function verifierRetard() {
      const trainNum = document.getElementById("trainInput").value.trim();
      const div = document.getElementById("resultat");

      if (!trainNum) {
        div.innerHTML = `<p style="color:red;">Veuillez entrer un numÃ©ro de train.</p>`;
        return;
      }

      const data = retards[trainNum];

      if (!data) {
        div.innerHTML = `<p>ğŸš« Aucun retard dÃ©tectÃ© pour le train ${trainNum}</p>`;
      } else {
        div.innerHTML = `<p>ğŸš„ <strong>Retards du train ${trainNum}</strong> :</p><pre>${JSON.stringify(data, null, 2)}</pre>`;
      }
    }
  </script>
</body>
</html>
