<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prochains Trains Nancy → Metz</title>
</head>
<body>
    <h1>Prochains Trains de Nancy vers Metz</h1>
    <div id="trainResults"></div>
    <button onclick="fetchTrains()">Actualiser les Horaires</button>

    <script>
        function fetchTrains() {
            // Récupérer l'heure actuelle au format ISO
            const now = new Date();
            const dateTimeNow = now.toISOString();

            // Codes des gares
            const fromStationCode = 'SNCF:OCE:SA:87141002';  // Nancy Ville
            const toStationCode = 'SNCF:OCE:SA:87192039';    // Metz Ville

            // URL de l'API SNCF avec l'heure actuelle
            const apiUrl = `https://api.sncf.com/v1/coverage/sncf/journeys?from=stop_area:${fromStationCode}&to=stop_area:${toStationCode}&date_time=${dateTimeNow}&key=242fac11-6d98-45fb-93df-28174d362447`;

            // Récupérer les données de l'API
            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    // Afficher les résultats ou un message d'erreur
                    const resultsContainer = document.getElementById('trainResults');
                    resultsContainer.innerHTML = '';

                    if (data.journeys && data.journeys.length > 0) {
                        data.journeys.forEach(train => {
                            const trainInfo = document.createElement('p');
                            trainInfo.innerHTML = `Train de ${train.from.stop_name} à ${train.to.stop_name} départ à ${train.departure_date_time}`;
                            resultsContainer.appendChild(trainInfo);
                        });
                    } else {
                        resultsContainer.innerHTML = "<p>Aucun train trouvé pour l'instant.</p>";
                    }
                })
                .catch(error => {
                    console.error('Erreur lors de la récupération des données:', error);
                    document.getElementById('trainResults').innerHTML = "<p>Erreur lors de la récupération des données. Veuillez réessayer.</p>";
                });
        }

        // Actualiser les horaires immédiatement lors du chargement de la page
        fetchTrains();
    </script>
</body>
</html>
