  <!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prochains Trains Nancy → Metz</title>
</head>
<body>
    <h1>Prochains Trains de Nancy vers Metz</h1>
    <button id="actualiserBtn">Actualiser</button>
    <div id="trainList"></div>

    <script>
        // Ta clé API
        const apiKey = "242fac11-6d98-45fb-93df-28174d362447";

        // Fonction pour récupérer les trains entre Nancy et Metz
        function getTrains() {
            const url = "https://api.navitia.io/v1/coverage/sncf/journeys?from=stop_area%3ASNCF%3A87141002&to=stop_area%3ASNCF%3A87141001&datetime=" + new Date().toISOString();

            fetch(url, {
                method: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + apiKey
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data && data.journeys) {
                    displayTrains(data.journeys);
                } else {
                    document.getElementById('trainList').innerHTML = "Aucun train trouvé dans l'intervalle de 5h.";
                }
            })
            .catch(error => {
                console.log("Erreur lors de la récupération des données:", error);
                document.getElementById('trainList').innerHTML = "Erreur lors de la récupération des données. Veuillez réessayer.";
            });
        }

        // Fonction pour afficher les trains sur la page
        function displayTrains(journeys) {
            let htmlContent = "<ul>";
            journeys.forEach(journey => {
                const departure = new Date(journey.departure_date_time).toLocaleTimeString();
                const arrival = new Date(journey.arrival_date_time).toLocaleTimeString();
                const line = journey.sections[0].line.name;
                const isDirect = journey.sections[0].from.name === "Nancy" && journey.sections[journey.sections.length - 1].to.name === "Metz";

                htmlContent += `<li>Train ${line}: Départ à ${departure}, Arrivée à ${arrival}, Direct: ${isDirect ? 'Oui' : 'Non'}</li>`;
            });
            htmlContent += "</ul>";
            document.getElementById('trainList').innerHTML = htmlContent;
        }

        // Actualiser les trains quand l'utilisateur clique sur le bouton "Actualiser"
        document.getElementById('actualiserBtn').addEventListener('click', getTrains);

        // Appel initial pour récupérer les trains dès que la page est chargée
        getTrains();
    </script>
</body>
</html>
