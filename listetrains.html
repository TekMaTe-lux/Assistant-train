<script>
    const apiKey = '242fac11-6d98-45fb-93df-28174d362447'; // Remplacez par votre clé API
    const encodedApiKey = btoa(apiKey + ":");

    const now = new Date(Date.now() - (61 * 60 * 1000)); // Prendre l'heure actuelle, moins 1h pour s'assurer qu'on récupère les trains à venir
    const yyyy = now.getFullYear();
    const mm = String(now.getMonth() + 1).padStart(2, '0');
    const dd = String(now.getDate()).padStart(2, '0');
    const hh = String(now.getHours()).padStart(2, '0');
    const min = String(now.getMinutes()).padStart(2, '0');
    const ss = String(now.getSeconds()).padStart(2, '0');

    const datetime = `${yyyy}${mm}${dd}T${hh}${min}${ss}`;

    // URL modifiée pour récupérer les horaires (stop_schedules) des prochains trains à partir de Luxembourg
    const url = `https://api.sncf.com/v1/coverage/sncf/stop_areas/stop_area:SNCF:82001000/stop_schedules?datetime=${datetime}`;

    fetch(url, {
        method: 'GET',
        headers: {
            "Authorization": "Basic " + encodedApiKey
        }
    })
    .then(response => response.json())
    .then(data => {
        const stopSchedules = data.stop_schedules;
        
        // Affichage des prochains trains
        stopSchedules.forEach(schedule => {
            const trainName = schedule.route.name;
            const departureTime = schedule.date_times[0].date_time;
            const direction = schedule.display_informations.direction;
            
            console.log(`Train: ${trainName}`);
            console.log(`Départ: ${departureTime}`);
            console.log(`Direction: ${direction}`);
            console.log('-----------------------------');
        });
    })
    .catch(error => {
        console.error("Erreur lors de la récupération des horaires:", error);
    });
</script>
