<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alertes SNCF en Temps Réel</title>
</head>
<body>
    <h1>Alertes en Temps Réel SNCF</h1>

    <h2>Alertes GTFS-RT</h2>
    <ul id="gtfs-rt-alertes"></ul>

    <h2>Alertes SIRI SX LITE</h2>
    <ul id="siri-sx-alertes"></ul>

    <script>
        // Fonction pour récupérer les alertes du GTFS-RT
        function getGTFSRTAlerts() {
            fetch('https://proxy.transport.data.gouv.fr/resource/sncf-gtfs-rt-service-alerts')
                .then(response => response.json())
                .then(data => {
                    const gtfsAlertsList = document.getElementById('gtfs-rt-alertes');
                    gtfsAlertsList.innerHTML = '';  // Réinitialiser la liste

                    // Parcours des alertes et ajout à la liste HTML
                    data.alerts.forEach(alert => {
                        const li = document.createElement('li');
                        li.textContent = `Alert ID: ${alert.id} - Message: ${alert.header_text}`;
                        gtfsAlertsList.appendChild(li);
                    });
                })
                .catch(error => {
                    console.error('Erreur lors de la récupération des alertes GTFS-RT:', error);
                });
        }

        // Fonction pour récupérer les alertes du SIRI SX LITE
        function getSIRISXAlerts() {
            fetch('https://proxy.transport.data.gouv.fr/resource/sncf-siri-lite-situation-exchange')
                .then(response => response.json())
                .then(data => {
                    const siriSXAlertsList = document.getElementById('siri-sx-alertes');
                    siriSXAlertsList.innerHTML = '';  // Réinitialiser la liste

                    // Parcours des alertes et ajout à la liste HTML
                    data.situations.forEach(situation => {
                        const li = document.createElement('li');
                        li.textContent = `Situation ID: ${situation.id} - Message: ${situation.summary}`;
                        siriSXAlertsList.appendChild(li);
                    });
                })
                .catch(error => {
                    console.error('Erreur lors de la récupération des alertes SIRI SX LITE:', error);
                });
        }

        // Appeler les fonctions pour récupérer les alertes initiales
        getGTFSRTAlerts();
        getSIRISXAlerts();

        // Rafraîchissement automatique des alertes toutes les 5 minutes
        setInterval(() => {
            getGTFSRTAlerts();
            getSIRISXAlerts();
        }, 300000);  // 300000 ms = 5 minutes
    </script>
</body>
</html>
