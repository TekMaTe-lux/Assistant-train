<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Liste des Trains</title>
  <script>
    // Liste des numéros de trains
    const trainIds = [
      "vehicle_journey:SNCF:2025-05-13:88700:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88770:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88702:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88704:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88706:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88708:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88710:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88802:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88712:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88501:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88804:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88714:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88503:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88806:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88716:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88505:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88718:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88571:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88722:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88724:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88726:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88730:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88720:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88734:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88509:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88736:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88738:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88511:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:837680:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:837682:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88513:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88740:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88727:1187:Train",
      "vehicle_journey:SNCF:2025-05-13:88729:1187:Train"
    ];

    // Fonction pour récupérer les détails d'un train en utilisant son ID
    async function getTrainDetails(trainId) {
      const response = await fetch(`https://api.sncf.com/v1/coverage/sncf/vehicle_journeys/${trainId}`);
      const data = await response.json();
      return data;
    }

    // Fonction pour afficher la liste des trains avec leurs états
    async function displayTrainStatus() {
      const resultDiv = document.getElementById("results");
      resultDiv.innerHTML = "<h3>Liste des Trains</h3>";

      for (const trainId of trainIds) {
        const trainData = await getTrainDetails(trainId);

        // Déterminer l'état du train
        const status = trainData.vehicle_journeys[0].disruptions.length > 0 ? "Retardé / Supprimé" : "Prévu";

        resultDiv.innerHTML += `
          <div>
            <h4>Train ${trainData.vehicle_journeys[0].name}</h4>
            <p>État : ${status}</p>
            <p><strong>Arrêts :</strong></p>
            <ul>
              ${trainData.vehicle_journeys[0].stop_times.map(stop => `
                <li>${stop.stop_point.label} - Arrivée : ${stop.arrival_time}, Départ : ${stop.departure_time}</li>
              `).join('')}
            </ul>
            <hr>
          </div>
        `;
      }
    }

    // Exécution de la fonction au chargement de la page
    window.onload = displayTrainStatus;
  </script>
</head>
<body>
  <h1>Affichage des Trains et de leur État</h1>
  <div id="results"></div>
</body>
</html>
