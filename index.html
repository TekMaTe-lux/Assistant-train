<!DOCTYPE html><html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Horaires Trains Thionville > Luxembourg</title>
</head>
<body>
  <h1>Horaires des Trains</h1>
  <label>De : <input type="time" id="start-time" value="06:00"></label>
  <label>À : <input type="time" id="end-time" value="09:00"></label>
  <button onclick="rechercherTrains()">Rechercher</button>  <ul id="resultats-trains"></ul>  <script>
    async function rechercherTrains() {
      const start = document.getElementById('start-time').value;
      const end = document.getElementById('end-time').value;

      const now = new Date();
      const dateStr = now.toISOString().split('T')[0].replace(/-/g, ''); // Format AAAAMMJJ

      const datetime = `${dateStr}T${start.replace(':', '')}`;
      const duration = 60 * (parseInt(end.split(':')[0]) - parseInt(start.split(':')[0])) * 60; // durée en secondes

      const url = `https://api.sncf.com/v1/coverage/sncf/journeys?from=stop_area:OCE:SA:87771504&to=stop_area:OCE:SA:87773002&datetime=${datetime}&duration=${duration}`;

      const headers = {
        'Authorization': 'Basic ' + btoa('242fac11-6d98-45fb-93df-28174d362447:')
      };

      const ul = document.getElementById('resultats-trains');
      ul.innerHTML = '<li>Chargement...</li>';

      try {
        const response = await fetch(url, { headers });
        const data = await response.json();
        ul.innerHTML = '';

        if (data.journeys && data.journeys.length > 0) {
          data.journeys.forEach(journey => {
            const departure = journey.departure_date_time.slice(9, 13);
            const heure = departure.slice(0, 2) + ':' + departure.slice(2);
            const status = journey.status || 'À l\'heure';
            const li = document.createElement('li');
            li.textContent = `Départ à ${heure} – Statut : ${status}`;
            ul.appendChild(li);
          });
        } else {
          ul.innerHTML = '<li>Aucun train trouvé dans cette plage horaire.</li>';
        }
      } catch (error) {
        console.error(error);
        ul.innerHTML = '<li>Erreur lors de la récupération des données.</li>';
      }
    }
  </script></body>
</html>
