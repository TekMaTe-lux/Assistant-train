<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Horaires des Trains Metz → Thionville</title>
</head>
<body>
  <h1>Horaires des Trains Metz → Thionville</h1>
  <button onclick="getTrains()">Afficher les horaires</button>
  <ul id="resultats"></ul>

  <script>
    async function getTrains() {
      const now = new Date();
      now.setHours(now.getHours() + 1); // ajoute 1h
      const iso = now.toISOString().replace(/[-:]/g, '').split('.')[0];
      const datetime = iso.slice(0, 13) + "00"; // format YYYYMMDDTHHMM00

      const url = `https://api.sncf.com/v1/coverage/sncf/journeys?from=stop_area:OCE:SA:8719200&to=stop_area:OCE:SA:8719210&datetime=${datetime}&duration=10800`;

      const response = await fetch(url, {
        headers: {
          "Authorization": "Basic " + btoa("242fac11-6d98-45fb-93df-28174d362447:")
        }
      });

      const data = await response.json();
      const list = document.getElementById("resultats");
      list.innerHTML = "";

      if (data.journeys && data.journeys.length > 0) {
        data.journeys.forEach(journey => {
          const dep = journey.departure_date_time;
          const arr = journey.arrival_date_time;
          const heureDep = dep.slice(9, 11) + ":" + dep.slice(11, 13);
          const heureArr = arr.slice(9, 11) + ":" + arr.slice(11, 13);
          const li = document.createElement("li");
          li.textContent = `Départ: ${heureDep} → Arrivée: ${heureArr}`;
          list.appendChild(li);
        });
      } else {
        list.innerHTML = "<li>Aucun train trouvé.</li>";
      }
    }
  </script>
</body>
</html>
